<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>A Data Engineering Perspective on Go vs. Python (Part 1) - Vitthal Mirji</title><link rel=icon type=image/png href=favicon.ico><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="A Data Engineering Perspective on Go vs. Python (Part 1)"><meta itemprop=description content="Exploring golang - can we ditch Python for go? And have we finally found a use case for go? Part 1 explores high-level differences between Python and go and gives specific examples on the two languages, aiming to answer the question based on Apache Beam and Google Dataflow as a real-world example."><meta itemprop=datePublished content="2020-06-11T00:00:00+00:00"><meta itemprop=dateModified content="2020-06-11T00:00:00+00:00"><meta itemprop=wordCount content="5374"><meta itemprop=keywords content="Go,Golang,Python,Dataflow,Beam,Spark,Big Data,Programming"><meta property="og:url" content="https://vitthalmirji.com/2020/06/a-data-engineering-perspective-on-go-vs.-python-part-1/"><meta property="og:site_name" content="Vitthal Mirji"><meta property="og:title" content="A Data Engineering Perspective on Go vs. Python (Part 1)"><meta property="og:description" content="Exploring golang - can we ditch Python for go? And have we finally found a use case for go? Part 1 explores high-level differences between Python and go and gives specific examples on the two languages, aiming to answer the question based on Apache Beam and Google Dataflow as a real-world example."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-06-11T00:00:00+00:00"><meta property="article:modified_time" content="2020-06-11T00:00:00+00:00"><meta property="article:tag" content="Go"><meta property="article:tag" content="Golang"><meta property="article:tag" content="Python"><meta property="article:tag" content="Dataflow"><meta property="article:tag" content="Beam"><meta property="article:tag" content="Spark"><meta name=twitter:card content="summary"><meta name=twitter:title content="A Data Engineering Perspective on Go vs. Python (Part 1)"><meta name=twitter:description content="Exploring golang - can we ditch Python for go? And have we finally found a use case for go? Part 1 explores high-level differences between Python and go and gives specific examples on the two languages, aiming to answer the question based on Apache Beam and Google Dataflow as a real-world example."><link rel=stylesheet type=text/css media=screen href=https://vitthalmirji.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://vitthalmirji.com/css/main.css><link rel=stylesheet type=text/css href=https://vitthalmirji.com/[css/override.css]><link id=dark-scheme rel=stylesheet type=text/css href=https://vitthalmirji.com/css/dark.css><script src=https://vitthalmirji.com/js/feather.min.js></script><script src=https://vitthalmirji.com/js/main.js></script></head><body><div class="container-wide wrapper"><link rel=icon href=../../../favicon.ico sizes=any><link rel=icon type=image/png href=../../../favicon.png><link rel=apple-touch-icon href=../../../apple-touch-icon.png><link rel=manifest href=../../../site.webmanifest><meta name=theme-color content="#ffffff"><link rel=stylesheet href=../../../syntax.css><div class=header><h1 class=site-title><a href=https://vitthalmirji.com/>Vitthal Mirji</a></h1><div class=site-description><p>Software Engineering, Data Engineering, GNU/Linux, Data, ML, and other things</p><nav class="nav social"><ul class=flat><li><a href=https://github.com/vim89/ title=Github><i data-feather=github></i></a></li><li><a href=https://twitter.com/whoami_vim/ title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://www.linkedin.com/in/vitthal10/ title=LinkedIn><i data-feather=linkedin></i></a></li><li><a href=../../../index.xml title=RSS><i data-feather=rss></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=../../../>Home</a></li><li><a href=../../../about>About</a></li><li><a href=../../../tags>Tags & Stats</a></li></ul></nav></div><div class=article-nav id=article-nav-id><div class=post><div class=post-header><div class=meta><div class=date><span class=day>11</span>
<span class=rest>Jun 2020</span></div></div><div class=matter><h1 class=title>A Data Engineering Perspective on Go vs. Python (Part 1)</h1></div></div><aside class=toc id=static-toc><header><h3>Contents</h3></header><nav id=TableOfContents><ol><li><a href=#introduction>Introduction</a></li><li><a href=#go-vs-python>Go vs. Python</a><ol><li><a href=#speed>Speed</a></li><li><a href=#static-typing>Static typing</a></li><li><a href=#interfaces-and-structs>Interfaces and Structs</a></li><li><a href=#pointers>Pointers</a></li></ol></li><li><a href=#concurrency-with-a-mandelbrot-set>Concurrency with a Mandelbrot Set</a><ol><li><a href=#python>Python</a></li><li><a href=#go>Go</a></li><li><a href=#final-performance>Final Performance</a></li></ol></li><li><a href=#real-life-considerations>Real-Life Considerations</a><ol><li><a href=#language-popularity>Language Popularity</a></li><li><a href=#ecosystem>Ecosystem</a></li><li><a href=#learning-curve>Learning Curve</a></li></ol></li><li><a href=#apache-beam>Apache Beam</a><ol><li><a href=#transformations>Transformations</a></li><li><a href=#io>I/O</a></li><li><a href=#runners>Runners</a></li><li><a href=#line-by-line-example>Line-by-Line Example</a></li></ol></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#next-steps>Next Steps</a></li></ol></nav></aside><h2 id=introduction>Introduction</h2><blockquote><p>Exploring golang - can we ditch Python for go? And have we (as in &ldquo;folks that work with a lot of data regularly&rdquo;)
finally found a use case for go? Part 1 explores high-level differences between Python and go and gives specific
examples on the two languages, aiming to answer the question based on Apache Beam and Google Dataflow as a real-world
example.</p></blockquote><p><a href=https://beam.apache.org/ target=_blank rel="nofollow noopener noreferrer">Apache Beam</a>
is something I&rsquo;ve used on this blog a couple of times before: It&rsquo;s a unified
programming model for both batch and streaming use cases that can
handle <a href=https://en.wikipedia.org/wiki/Embarrassingly_parallel target=_blank rel="nofollow noopener noreferrer">delightfully parallel workloads</a>
, allows for a lot of
custom I/O and other connectors, and runs on a multitude of execution platforms, most notably Flink, Spark, and Google
Cloud&rsquo;s Dataflow.</p><p>You can use it for streaming or batching data to analyze it, run ETL, enrich it - you name it. I&rsquo;ve actually used <code>Beam</code>
some years
ago <a href=https://vitthalmirji.com/blog/2018/06/analyzing-reddits-top-posts-images-with-google-cloud-part-1/#introducing-data-flow target=_blank rel="nofollow noopener noreferrer">here</a>
.</p><p>Now, if you were to go to Beam&rsquo;s website, you&rsquo;ll find this wonderful graphic:
<img src=images/beam_architecture.png alt="Beam Languages"></p><p>Which tells you that Beam is to be written in either <code>Java</code> or <code>Python</code> and everything else falls under &ldquo;Other
Languages&rdquo;.</p><p>There is, however, an &ldquo;experimental&rdquo; <a href=https://beam.apache.org/documentation/sdks/go/ target=_blank rel="nofollow noopener noreferrer"><code>go sdk</code></a>
(<a href=https://github.com/apache/beam/tree/master/sdks/go target=_blank rel="nofollow noopener noreferrer">GitHub</a>
)
that promises us to use <code>go</code> instead of <code>Python</code> - and that&rsquo;s what got me excited.</p><p>The next section will poorly attempt to give a &ldquo;short&rdquo; (~3,000 word) introduction to <code>go</code> and compare it to <code>Python</code>
based on the different handling data engineering specific use cases and when using multi-threaded applications. Please
note that this is by no means a full comparison.</p><blockquote><p>This is Part 1 of 2, focussing on the two languages and the current state of the Apache Beam SDK. In part 2 (coming
soon), we&rsquo;ll explore how to use the <code>Beam</code> <code>go</code> SDK, what limitations we&rsquo;ll face on GCP, and where the journey for
<code>go</code>
for data engineers is headed.</p></blockquote><p><em>All example code is available
on <a href=https://github.com/vim89/vitthalmirji.com/tree/master/content/posts/2020/06/a-data-engineering-perspective-on-go-vs-python-part-1/code target=_blank rel="nofollow noopener noreferrer">GitHub</a></em></p><h2 id=go-vs-python>Go vs. Python</h2><p>In case you are not familiar, let me quote Wikipedia:</p><blockquote><p>Go is a statically typed, compiled programming language designed at Google by Robert Griesemer, Rob Pike, and Ken
Thompson.
Go is syntactically similar to C, but with memory safety, garbage collection, structural typing, and CSP-style
concurrency.</p><p><a href=https://en.wikipedia.org/wiki/Go_%28programming_language%29 target=_blank rel="nofollow noopener noreferrer">https://en.wikipedia.org/wiki/Go_(programming_language)</a></p></blockquote><p><code>Go</code> has a lot of concepts that should get you excited for a parallel execution framework that handles data. In the
following sections, we&rsquo;ll explore some hand-picked concepts and examples and conclude with a longer, more in-depth
concurrency sample.</p><h3 id=speed>Speed</h3><p><code>go</code>, being a complied as opposed to an interpreted language,
is <a href=https://benchmarksgame-team.pages.debian.net/benchmarksgame/fastest/go-python3.html target=_blank rel="nofollow noopener noreferrer">supposed to be faster than Python</a>
.
It also has a tendency to compile things really quickly and shipping compiled code to end-users is orders of magnitude
easier than attempting to do the same with Python.</p><p>You can find some hands-on examples below.</p><p><img src=images/gopyperf.png alt></p><h3 id=static-typing>Static typing</h3><p>Static, as opposed to <code>Python</code>&rsquo;s dynamic typing, avoids a lot type headaches with using the right data type in the right
moment.</p><blockquote><p>I am not attempting to start a general comparison between static and dynamic typing and the intricacies of Python, but
merely looking at it from my experience, specifically in the data space, on a day-to-day basis.</p></blockquote><p>In data-driven projects, you will constantly find yourself dealing with very strict data type definitions, often an
artifact (and rightfully so) of an area where all corporate data was inevitably stored in a large RDMBs, such as Oracle,
enforcing strict typing.</p><p>Python-based frameworks, such as <code>pySpark</code> or even <code>pandas</code>, ship with their own abstraction layer for providing
types (<a href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dtypes.html target=_blank rel="nofollow noopener noreferrer">see dtypes</a>
).</p><p>Take this code, written for <code>pySpark</code>, a popular data processing framework that is available in Python (amongst others)
for instance, using the NYC Yellow Cab data [0].</p><p>First, read a CSV file into an <code>RDD</code>, a &ldquo;resilient, distributed dataset&rdquo;, and apply some transformation lambdas on each
line in the data set.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Read data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rdd</span> <span class=o>=</span> <span class=n>sc</span><span class=o>.</span><span class=n>textFile</span><span class=p>(</span><span class=s1>&#39;data/yellow_tripdata_2019-01.csv&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Parse the RDD</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rdd</span> <span class=o>=</span> <span class=n>rdd</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>r</span><span class=p>:</span> <span class=n>r</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>))</span>\
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>r</span><span class=p>:</span> <span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=mi>10</span><span class=p>],</span><span class=n>r</span><span class=p>[</span><span class=mi>13</span><span class=p>]))</span> <span class=c1># Take &#39;fare_amount&#39; and &#39;tip_amount&#39;</span>
</span></span><span class=line><span class=cl><span class=n>rdd</span> <span class=o>=</span> <span class=n>rdd</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>r</span><span class=p>:</span> <span class=s1>&#39;fare_amount&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>r</span><span class=p>)</span> <span class=c1># filter header</span>
</span></span><span class=line><span class=cl><span class=n>rdd</span><span class=o>.</span><span class=n>take</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div></p><p>Which yields:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[(</span><span class=s1>&#39;7&#39;</span>, <span class=s1>&#39;1.65&#39;</span><span class=o>)</span>, <span class=o>(</span><span class=s1>&#39;14&#39;</span>, <span class=s1>&#39;1&#39;</span><span class=o>)</span>, <span class=o>(</span><span class=s1>&#39;4.5&#39;</span>, <span class=s1>&#39;0&#39;</span><span class=o>)</span>, <span class=o>(</span><span class=s1>&#39;3.5&#39;</span>, <span class=s1>&#39;0&#39;</span><span class=o>)</span>, <span class=o>(</span><span class=s1>&#39;52&#39;</span>, <span class=s1>&#39;0&#39;</span><span class=o>)]</span></span></span></code></pre></td></tr></table></div></div></p><p>If we look into one of the tuples:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>type</span><span class=p>(</span><span class=n>rdd</span><span class=o>.</span><span class=n>take</span><span class=p>(</span><span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span></span></span></code></pre></td></tr></table></div></div></p><p>We&rsquo;ll see <code>str</code> as the data type.</p><p>Now, if we were to reduce this to sum up the Taxi fare and tip amount:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>sum_fares</span><span class=p>(</span><span class=n>fare</span><span class=p>,</span> <span class=n>tip</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>fare</span> <span class=o>+</span> <span class=n>tip</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rdd</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>r</span><span class=p>:</span> <span class=n>sum_fares</span><span class=p>(</span><span class=o>*</span><span class=n>r</span><span class=p>))</span><span class=o>.</span><span class=n>take</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div></p><p>As the quotes in the above output indicate, the result is a list of concatenated <code>strings</code>.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span><span class=s1>&#39;71.65&#39;</span>, <span class=s1>&#39;141&#39;</span>, <span class=s1>&#39;4.50&#39;</span>, <span class=s1>&#39;3.50&#39;</span>, <span class=s1>&#39;520&#39;</span><span class=o>]</span></span></span></code></pre></td></tr></table></div></div></p><p>Instead of the mathematically correct:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>rdd</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>r</span><span class=p>:</span> <span class=n>sum_fares</span><span class=p>(</span><span class=o>*</span><span class=p>[</span><span class=nb>float</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>r</span><span class=p>]))</span><span class=o>.</span><span class=n>take</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># [8.65, 15.0, 4.5, 3.5, 52.0]</span></span></span></code></pre></td></tr></table></div></div></p><p>Newer versions of Python support <code>type hints</code> and the Python interpreter keeps track of variable types. However, as the
above example highlights, I personally find it hard to maintain a consistent, readable, and maintainable code base,
especially on complex applications.</p><p><code>go</code>, on the other hand, is statically typed.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl><span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=s>&#34;reflect&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=c1>// Implicit</span>
</span></span><span class=line><span class=cl><span class=nx>str</span> <span class=o>:=</span> <span class=s>&#34;A String&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%s is %s\n&#34;</span><span class=p>,</span> <span class=nx>str</span><span class=p>,</span> <span class=nx>reflect</span><span class=p>.</span><span class=nf>TypeOf</span><span class=p>(</span><span class=nx>str</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Explicit</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>x</span> <span class=kt>float64</span> <span class=p>=</span> <span class=mf>3.14</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%v is %s\n&#34;</span><span class=p>,</span> <span class=nx>x</span><span class=p>,</span> <span class=nx>reflect</span><span class=p>.</span><span class=nf>TypeOf</span><span class=p>(</span><span class=nx>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>Will yield:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go run test.go
</span></span><span class=line><span class=cl>A String is string
</span></span><span class=line><span class=cl>3.14 is float64</span></span></code></pre></td></tr></table></div></div></p><p>Whereas this:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>str</span> <span class=p>=</span> <span class=nx>x</span></span></span></code></pre></td></tr></table></div></div></p><p>Won&rsquo;t compile:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go run testvar.go
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># command-line-arguments</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>./test.go:15:6: cannot use x <span class=o>(</span><span class=nb>type</span> float64<span class=o>)</span> as <span class=nb>type</span> string in assignment</span></span></code></pre></td></tr></table></div></div><p>Go does not support <code>Generics</code>, but neither does <code>Python</code>.</p><blockquote><p>I have skipped over <code>go</code>&rsquo;s <code>empty interface{}</code> concept to support arbitrary values and to handle unknown types; it is
possible to use this concept for several corner cases where an abstraction of weak types are required</p></blockquote><p><em>[0] <code>Spark</code>&rsquo;s SQL interface will infer string types and allows for mathematical operations on Strings, if they are
consistent</em></p><h3 id=interfaces-and-structs>Interfaces and Structs</h3><p><code>Python</code> does have a <code>class</code> structure (and I&rsquo;ve used it extensively), whereas <code>go</code> uses <code>structs</code> and <code>interfaces</code> (and
this is a terrible simplification). <code>go</code> does not have inheritance and relies on interfaces and composition.</p><p>In the data world, having a strict class structure, for instance to abstract transformations, statistical models, or
just plain old data structures, can be both a pain and a curse.</p><p><code>Python</code> makes extensive use of <code>dicts</code> that can hold arbitrary key-value pairs and nested structures and are similar in
syntax to <code>JSON</code>, as well as defined <code>class</code>es for structured abstractions of data. Almost every data framework ships
with their own <code>schema</code> classes. <code>go</code>, in theory, could avoid that through a combination of <code>interfaces</code> (for
standards), static typing (to ensure the right data type is used at the right moment), and <code>structs</code> to define structure
and logic.</p><p>Here&rsquo;s an questionably useful example that uses the interface <code>CoordinateData</code>, with the function <code>calculateDistance</code>,
to calculate a distance between 2 coordinate tuples in the world&rsquo;s worst GIS analytics platform :)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl><span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=s>&#34;math&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// A Resource we&#39;re trying to access</span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>CoordinateData</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nf>calculateDistance</span><span class=p>(</span><span class=nx>latTo</span><span class=p>,</span> <span class=nx>lonTo</span> <span class=kt>float64</span><span class=p>)</span> <span class=kt>float64</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>We then implement Geospatial data and the Haversine function (to approximate distance on earth):<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GeospatialData</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>lat</span><span class=p>,</span> <span class=nx>lon</span> <span class=kt>float64</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>const</span> <span class=nx>earthRadius</span> <span class=p>=</span> <span class=nb>float64</span><span class=p>(</span><span class=mi>6371</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>d</span> <span class=nx>GeospatialData</span><span class=p>)</span> <span class=nf>calculateDistance</span><span class=p>(</span><span class=nx>latTo</span><span class=p>,</span> <span class=nx>lonTo</span> <span class=kt>float64</span><span class=p>)</span> <span class=kt>float64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=c1>// Haversine distance</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>deltaLat</span> <span class=p>=</span> <span class=p>(</span><span class=nx>latTo</span> <span class=o>-</span> <span class=nx>d</span><span class=p>.</span><span class=nx>lat</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=nx>math</span><span class=p>.</span><span class=nx>Pi</span> <span class=o>/</span> <span class=mi>180</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>deltaLon</span> <span class=p>=</span> <span class=p>(</span><span class=nx>lonTo</span> <span class=o>-</span> <span class=nx>d</span><span class=p>.</span><span class=nx>lon</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=nx>math</span><span class=p>.</span><span class=nx>Pi</span> <span class=o>/</span> <span class=mi>180</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>a</span> <span class=p>=</span> <span class=nx>math</span><span class=p>.</span><span class=nf>Sin</span><span class=p>(</span><span class=nx>deltaLat</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span> <span class=o>*</span> <span class=nx>math</span><span class=p>.</span><span class=nf>Sin</span><span class=p>(</span><span class=nx>deltaLat</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>		<span class=nx>math</span><span class=p>.</span><span class=nf>Cos</span><span class=p>(</span><span class=nx>d</span><span class=p>.</span><span class=nx>lat</span> <span class=o>*</span> <span class=p>(</span><span class=nx>math</span><span class=p>.</span><span class=nx>Pi</span> <span class=o>/</span> <span class=mi>180</span><span class=p>))</span> <span class=o>*</span> <span class=nx>math</span><span class=p>.</span><span class=nf>Cos</span><span class=p>(</span><span class=nx>latTo</span> <span class=o>*</span> <span class=p>(</span><span class=nx>math</span><span class=p>.</span><span class=nx>Pi</span> <span class=o>/</span> <span class=mi>180</span><span class=p>))</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>		<span class=nx>math</span><span class=p>.</span><span class=nf>Sin</span><span class=p>(</span><span class=nx>deltaLon</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span> <span class=o>*</span> <span class=nx>math</span><span class=p>.</span><span class=nf>Sin</span><span class=p>(</span><span class=nx>deltaLon</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>c</span> <span class=p>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=nx>math</span><span class=p>.</span><span class=nf>Atan2</span><span class=p>(</span><span class=nx>math</span><span class=p>.</span><span class=nf>Sqrt</span><span class=p>(</span><span class=nx>a</span><span class=p>),</span><span class=nx>math</span><span class=p>.</span><span class=nf>Sqrt</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=nx>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>earthRadius</span> <span class=o>*</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></p><p>And the same on a simple, 2-dimensional plane:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>CartesianPlaneData</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span> <span class=kt>float64</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>d</span> <span class=nx>CartesianPlaneData</span><span class=p>)</span> <span class=nf>calculateDistance</span><span class=p>(</span><span class=nx>xTo</span><span class=p>,</span> <span class=nx>yTo</span> <span class=kt>float64</span><span class=p>)</span> <span class=kt>float64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=c1>// Simple 2-dimensional Euclidean distance</span>
</span></span><span class=line><span class=cl><span class=nx>dx</span> <span class=o>:=</span> <span class=p>(</span><span class=nx>xTo</span> <span class=o>-</span> <span class=nx>d</span><span class=p>.</span><span class=nx>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>dy</span> <span class=o>:=</span> <span class=p>(</span><span class=nx>yTo</span> <span class=o>-</span> <span class=nx>d</span><span class=p>.</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=nx>math</span><span class=p>.</span><span class=nf>Sqrt</span><span class=p>(</span> <span class=nx>dx</span><span class=o>*</span><span class=nx>dx</span> <span class=o>+</span> <span class=nx>dy</span><span class=o>*</span><span class=nx>dy</span> <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></p><p>In this case, the <code>main()</code> function simply calculates 2 completely different types of distance:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>atlanta</span> <span class=o>:=</span> <span class=nx>GeospatialData</span><span class=p>{</span><span class=mf>33.753746</span><span class=p>,</span> <span class=o>-</span><span class=mf>84.386330</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>distance</span> <span class=o>:=</span> <span class=nx>atlanta</span><span class=p>.</span><span class=nf>calculateDistance</span><span class=p>(</span><span class=mf>33.957409</span><span class=p>,</span> <span class=o>-</span><span class=mf>83.376801</span><span class=p>)</span> <span class=c1>// to Athens, GA</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;The Haversine distance between Atlanta, GA and Athens, GA is %v\n&#34;</span><span class=p>,</span> <span class=nx>distance</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>pointA</span> <span class=o>:=</span> <span class=nx>CartesianPlaneData</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>distanceA</span> <span class=o>:=</span> <span class=nx>pointA</span><span class=p>.</span><span class=nf>calculateDistance</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;The Pythagorean distance from (1,1) to (5,5) is %v\n&#34;</span><span class=p>,</span> <span class=nx>distanceA</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></p><p>Of course, this is a very simplistic example that simply forces structure onto your structs. However, comparing it to
Python, my options are limited:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>CoordinateData</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>calculateDistance</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>latTo</span><span class=p>,</span> <span class=n>lonTo</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>GeospatialData</span><span class=p>(</span><span class=n>CoordinateData</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>lat</span><span class=p>,</span> <span class=n>lon</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>lat</span> <span class=o>=</span> <span class=n>lat</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>long</span> <span class=o>=</span> <span class=n>lon</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculateDistance</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>latTo</span><span class=p>,</span> <span class=n>lonTo</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Haversine goes here :)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mf>95.93196816811724</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CartesianPlaneData</span><span class=p>(</span><span class=n>CoordinateData</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Let&#39;s not implement calculateDistance()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>atlanta</span> <span class=o>=</span> <span class=n>GeospatialData</span><span class=p>(</span><span class=mf>33.753746</span><span class=p>,</span> <span class=o>-</span><span class=mf>84.386330</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>distance</span> <span class=o>=</span> <span class=n>atlanta</span><span class=o>.</span><span class=n>calculateDistance</span><span class=p>(</span><span class=mf>33.957409</span><span class=p>,</span> <span class=o>-</span><span class=mf>83.376801</span><span class=p>)</span> <span class=c1># to Athens, GA</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;The Haversine distance between Atlanta, GA and Athens, GA is </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>distance</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>pointA</span> <span class=o>=</span> <span class=n>CartesianPlaneData</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>distanceA</span> <span class=o>=</span> <span class=n>pointA</span><span class=o>.</span><span class=n>calculateDistance</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;The Pythagorean distance from (1,1) to (5,5) is </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>distanceA</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;pointA is of type </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>pointA</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__bases__</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div><p>This is valid Python - <code>CartesianPlaneData</code> is a subclass (<em>not an interface</em> - Python uses duck-typing) of
<code>CoordinateData</code> and hence, simply uses the <code>calculateDistance</code> method without a return type (see above for static vs.
dynamic typing), runs, and returns:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 interface_example.py
</span></span><span class=line><span class=cl>The Haversine distance between Atlanta, GA and Athens, GA is 95.93196816811724
</span></span><span class=line><span class=cl>The Pythagorean distance from <span class=o>(</span>1,1<span class=o>)</span> to <span class=o>(</span>5,5<span class=o>)</span> is None
</span></span><span class=line><span class=cl>pointA is of <span class=nb>type</span> <span class=o>(</span>&lt;class <span class=s1>&#39;__main__.CoordinateData&#39;</span>&gt;,<span class=o>)</span></span></span></code></pre></td></tr></table></div></div><p>Python does still allow for interface abstractions and you can absolutely use classes to define hierarchies and logic,
as I&rsquo;ve done with the below <code>PluginInterceptor</code> to determine whether a custom Plugin is part of a defined base class;
this, however, is not enforced during runtime and might go belly-up if you implement it incorrectly.</p><p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>PluginInterceptor</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;Loads all allowed plugins, when they are a subclass of `BasePlugin` and have the constant `name` set (not `__name__`)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>cls</span> <span class=o>=</span> <span class=n>BasePlugin</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>allowed_plugins</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__load__allowed_plugins__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__get_all_subclasses__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=bp>cls</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>set</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>())</span><span class=o>.</span><span class=n>union</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=n>s</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__get_all_subclasses__</span><span class=p>(</span><span class=n>c</span><span class=p>)])</span> 
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__load__allowed_plugins__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>__allowed_plugins__</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=bp>cls</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>__get_all_subclasses__</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>cls</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=bp>cls</span><span class=o>.</span><span class=n>name</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>__allowed_plugins__</span><span class=p>[</span><span class=bp>cls</span><span class=o>.</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=bp>cls</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>__allowed_plugins__</span></span></span></code></pre></td></tr></table></div></div><a href=https://github.com/vim89/scarecrow/blob/master/plugin_base/interceptor.py#L5 target=_blank rel="nofollow noopener noreferrer">https://github.com/vim89/scarecrow/blob/master/plugin_base/interceptor.py#L5</a></p><p>You will also find an example of a struct used in the Mandelbrot example below.</p><h3 id=pointers>Pointers</h3><p><code>go</code> knows pointers, but no pointer arithmetic. Pointers in <code>go</code> are used for pass-by-pointer operations, as opposed to
pass-by-value. I won&rsquo;t go into this too much and leave you with an example from <code>go</code> and refer you
to <a href=https://robertheaton.com/2014/02/09/pythons-pass-by-object-reference-as-explained-by-philip-k-dick/ target=_blank rel="nofollow noopener noreferrer">this wonderful post</a>
for Python.</p><p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>i</span><span class=p>,</span> <span class=nx>j</span> <span class=o>:=</span> <span class=mi>42</span><span class=p>,</span> <span class=mi>2701</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>p</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>i</span>         <span class=c1>// point to i</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>*</span><span class=nx>p</span><span class=p>)</span> <span class=c1>// read i through the pointer</span>
</span></span><span class=line><span class=cl>	<span class=o>*</span><span class=nx>p</span> <span class=p>=</span> <span class=mi>21</span>         <span class=c1>// set i through the pointer</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>  <span class=c1>// see the new value of i</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>p</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>j</span>         <span class=c1>// point to j</span>
</span></span><span class=line><span class=cl>	<span class=o>*</span><span class=nx>p</span> <span class=p>=</span> <span class=o>*</span><span class=nx>p</span> <span class=o>/</span> <span class=mi>37</span>   <span class=c1>// divide j through the pointer</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>j</span><span class=p>)</span> <span class=c1>// see the new value of j</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div>(From <a href=https://tour.golang.org/moretypes/1 target=_blank rel="nofollow noopener noreferrer">https://tour.golang.org/moretypes/1</a>
)</p><p>My short summary for <code>go</code> would be: As a developer, I am able to control whether I&rsquo;d like the standard <code>C</code>-style
behavior - pass-by-value - or a pointer, where I still pass by value - but in this case, a <em>pointer to the value</em> as
function argument.</p><h2 id=concurrency-with-a-mandelbrot-set>Concurrency with a Mandelbrot Set</h2><p>Easy, out-of-the-box, easy-to-use concurrency is one of the most wonderful things in <code>go</code>. It takes a total of two
letters - <code>go</code> - to move something from synchronous to concurrent.</p><p>Let&rsquo;s use a &ldquo;pleasingly parallel&rdquo; algorithm, the <strong>Mandelbrot Set</strong>.</p><p>The Mandelbrot set is the set of complex numbers <code>c</code> for which the function
<img class=inline-img src=images/mbf1.svg alt decoding=async>
does not diverge when iterated from
<img class=inline-img src=images/mbf2.svg alt decoding=async>
, i.e., for which the
sequence {{ <inlineimg src=images/mbf3.svg>}},
<img class=inline-img src=images/mbf4.svg alt decoding=async>
, etc., remains bounded in
absolute value.
<a href=https://en.wikipedia.org/wiki/Mandelbrot_set target=_blank rel="nofollow noopener noreferrer">https://en.wikipedia.org/wiki/Mandelbrot_set</a></p><p><img src=images/mandelbrot.png alt></p><h3 id=python>Python</h3><p>Let&rsquo;s look at Python first.</p><p>Python offers a multitude of ways to express concurrency - <code>threading</code>, <code>multiprocessing</code>, <code>subprocesses</code>,
<code>concurrent.futures</code> to name a few - but choosing the correct one <em>and</em> writing legible code is a challenge. Allow me to
quote the docs:</p><blockquote><p>The modules described in this chapter provide support for concurrent execution of code. The appropriate choice of tool
will depend on the task to be executed (CPU bound vs IO bound) and preferred style of development (event driven
cooperative multitasking vs preemptive multitasking)
<a href=https://docs.python.org/3/library/concurrency.html target=_blank rel="nofollow noopener noreferrer">https://docs.python.org/3/library/concurrency.html</a></p></blockquote><p>I will not go into the details on what is the right choice for which situation, how the Global Python Interpreter (GIL)
affects it, or how everything works under the hood, as there are hundreds of great articles on the topic that can be
easily found online. What I would like to focus on, however, are code style, ease-of-use, and performance.</p><h4 id=single-threaded>Single-Threaded</h4><p>This can be expressed as such (by <a href=https://github.com/danyaal/mandelbrot target=_blank rel="nofollow noopener noreferrer">danyaal</a>
, with adjustments by yours truly):</p><blockquote><p>Keep in mind that there are a lot more, quicker, optimized, but also more <em>complex</em> versions; the below examples are
supposed to be simple & straightforward and can be translated almost 1:1 between <code>go</code> and <code>Python</code></p></blockquote><p>First, we define the iterations for the algorithm. This is the part that can be run in parallel, as we&rsquo;ll see in a
second.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># counts the number of iterations until the function diverges or</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># returns the iteration threshold that we check until</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>countIterationsUntilDivergent</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>threshold</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=n>z</span> <span class=o>=</span> <span class=nb>complex</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>iteration</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>threshold</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=n>z</span> <span class=o>=</span> <span class=p>(</span><span class=n>z</span><span class=o>*</span><span class=n>z</span><span class=p>)</span> <span class=o>+</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>iteration</span></span></span></code></pre></td></tr></table></div></div></p><p>The next function is a bit of a monolith, but in the end, simply creates both the real and imaginary axis, assigns them
to a 2-dimensional array, and runs the loop.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>mandelbrot</span><span class=p>(</span><span class=n>threshold</span><span class=p>,</span> <span class=n>density</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># location and size of the atlas rectangle</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># realAxis = np.linspace(-2.25, 0.75, density)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># imaginaryAxis = np.linspace(-1.5, 1.5, density)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>realAxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mf>0.22</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.219</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>imaginaryAxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mf>0.70</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.699</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>realAxisLen</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>realAxis</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>imaginaryAxisLen</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>imaginaryAxis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2-D array to represent mandelbrot atlas</span>
</span></span><span class=line><span class=cl>    <span class=n>atlas</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty</span><span class=p>((</span><span class=n>realAxisLen</span><span class=p>,</span> <span class=n>imaginaryAxisLen</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;realAxisLen: </span><span class=si>{}</span><span class=s1>, imaginaryAxisLen: </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>realAxisLen</span><span class=p>,</span> <span class=n>imaginaryAxisLen</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># color each point in the atlas depending on the iteration count</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>ix</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>realAxisLen</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>iy</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>imaginaryAxisLen</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>cx</span> <span class=o>=</span> <span class=n>realAxis</span><span class=p>[</span><span class=n>ix</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>cy</span> <span class=o>=</span> <span class=n>imaginaryAxis</span><span class=p>[</span><span class=n>iy</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>c</span> <span class=o>=</span> <span class=nb>complex</span><span class=p>(</span><span class=n>cx</span><span class=p>,</span> <span class=n>cy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>atlas</span><span class=p>[</span><span class=n>ix</span><span class=p>,</span> <span class=n>iy</span><span class=p>]</span> <span class=o>=</span> <span class=n>countIterationsUntilDivergent</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>threshold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>atlas</span><span class=o>.</span><span class=n>T</span>   </span></span></code></pre></td></tr></table></div></div></p><p>The computation happens on a single thread, as can be seen here:</p><p><img src=images/mandelbrot_py1.png alt></p><h4 id=multi-threaded>Multi-Threaded</h4><p>Now, for running it in multiple threads, we can use the <code>multiprocessing</code> module and run it like this.</p><p>The <code>calc_row()</code> function can be simplified, but it indicates what we&rsquo;re doing differently: Calculating the image
row-by-row, as opposed to one point at a time.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>multiprocessing</span> <span class=k>as</span> <span class=nn>mp</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>calc_row</span><span class=p>(</span><span class=n>cx</span><span class=p>,</span> <span class=n>cy</span><span class=p>,</span> <span class=n>threshold</span><span class=o>=</span><span class=mi>120</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=nb>complex</span><span class=p>(</span><span class=n>cx</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>cy</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=p>(</span><span class=n>cx</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>cy</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>countIterationsUntilDivergent</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>threshold</span><span class=p>))</span></span></span></code></pre></td></tr></table></div></div></p><p>Next, I made the questionable decision to simplify the loop by using <code>starmap</code> and a <code>Pool</code>, giving it permutations of
the nested loop directly as arguments.</p><p>In other words, we&rsquo;re running <code>calc_row(cx, cy, threshold)</code> on however many processes we give the process pool. The
<code>multiprocessing</code> library takes care of passing the arguments from our <code>list</code> or <code>iterator</code> respectively.</p><p>We are also returning a funky-looking tuple, so we can keep track of the index in the image.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>mandelbrot_multi</span><span class=p>(</span><span class=n>threshold</span><span class=p>,</span> <span class=n>density</span><span class=p>,</span> <span class=n>cpus</span><span class=o>=</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=n>realAxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mf>0.22</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.219</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>imaginaryAxis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mf>0.70</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.699</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>realAxisLen</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>realAxis</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>imaginaryAxisLen</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>imaginaryAxis</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>atlas</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty</span><span class=p>((</span><span class=n>realAxisLen</span><span class=p>,</span> <span class=n>imaginaryAxisLen</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Create list of permutations</span>
</span></span><span class=line><span class=cl>    <span class=n>realAxis</span> <span class=o>=</span> <span class=p>[(</span><span class=n>i</span><span class=p>,</span><span class=n>e</span> <span class=p>)</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span><span class=n>e</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>realAxis</span><span class=p>)]</span> 
</span></span><span class=line><span class=cl>    <span class=n>imaginaryAxis</span> <span class=o>=</span> <span class=p>[(</span><span class=n>i</span><span class=p>,</span><span class=n>e</span> <span class=p>)</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span><span class=n>e</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>imaginaryAxis</span><span class=p>)]</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>paramlist</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>itertools</span><span class=o>.</span><span class=n>product</span><span class=p>(</span><span class=n>realAxis</span><span class=p>,</span> <span class=n>imaginaryAxis</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>paramlist</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>t</span><span class=p>:</span> <span class=n>t</span> <span class=o>+</span> <span class=p>(</span><span class=n>threshold</span><span class=p>,),</span><span class=n>paramlist</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Create a multiprocessing pool</span>
</span></span><span class=line><span class=cl>    <span class=n>pool</span> <span class=o>=</span> <span class=n>mp</span><span class=o>.</span><span class=n>Pool</span><span class=p>(</span><span class=n>cpus</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=n>pool</span><span class=o>.</span><span class=n>starmap</span><span class=p>(</span><span class=n>calc_row</span><span class=p>,</span> <span class=n>paramlist</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pool</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>pool</span><span class=o>.</span><span class=n>join</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>n</span><span class=p>,</span> <span class=n>atlas</span></span></span></code></pre></td></tr></table></div></div><p>Which uses our available resources a lot more cleverly:
<img src=images/mandelbrot_py2.png alt></p><p>From a performance standpoint, we&rsquo;re looking at <strong>8.4s</strong> on a single CPU and <strong>2.53s</strong> concurrently, with a noticeable
memory overhead due to the use of the <code>mutliprocessing</code> module.</p><blockquote><p>There are of course a lot of different ways of speeding this up - <code>Cython</code>, optimized <code>numpy</code>, <code>tensorflow</code>, to name a
few - but looking at out-of-the-box concurrency, let&rsquo;s compare that to <code>go</code>. I am not good at choosing examples and
fractals are pretty. :)</p></blockquote><h3 id=go>Go</h3><p>Let&rsquo;s look at how it looks in <code>go</code>.</p><h4 id=single-threaded-1>Single-Threaded</h4><p>The single threaded version isn&rsquo;t too different. I&rsquo;m re-using the same code, but simply re-wrote it in <code>go</code>.</p><blockquote><p>Most <code>go</code> implementations are using the <code>Image</code> package to generate the image in go - and that makes sense for a
self-contained project. Here, however, I wrote the array to disk and read it in <code>numpy</code> and therefore, <code>Python</code>, to
keep
the code concise.
Performance numbers for both <code>Python</code> and <code>go</code> are <strong>just the calculation</strong>, not I/O or drawing pixels!</p></blockquote><p>First, we import the required packages and write a <code>np.linespace()</code> equivalent that returns evenly spaced numbers over a
specified interval.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl><span class=s>&#34;bytes&#34;</span>
</span></span><span class=line><span class=cl><span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl><span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl><span class=s>&#34;math/cmplx&#34;</span>
</span></span><span class=line><span class=cl><span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=s>&#34;strings&#34;</span>
</span></span><span class=line><span class=cl><span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;encoding/binary&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>linspace</span><span class=p>(</span><span class=nx>start</span><span class=p>,</span> <span class=nx>end</span> <span class=kt>float64</span><span class=p>,</span> <span class=nx>num</span> <span class=kt>int</span><span class=p>)</span> <span class=p>[]</span><span class=kt>float64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>result</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>float64</span><span class=p>,</span> <span class=nx>num</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>step</span> <span class=o>:=</span> <span class=p>(</span><span class=nx>end</span> <span class=o>-</span> <span class=nx>start</span><span class=p>)</span> <span class=o>/</span> <span class=nb>float64</span><span class=p>(</span><span class=nx>num</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>result</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>result</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>=</span> <span class=nx>start</span> <span class=o>+</span> <span class=nb>float64</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span><span class=o>*</span><span class=nx>step</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=nx>result</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></p><p>The rest of the code should look familiar - note the very specific, strongly typed data types, and return types.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>countIterationsUntilDivergent</span><span class=p>(</span><span class=nx>c</span> <span class=kt>complex128</span><span class=p>,</span> <span class=nx>threshold</span> <span class=kt>int64</span><span class=p>)</span> <span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>z</span> <span class=o>:=</span> <span class=nb>complex</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>ix</span> <span class=kt>int64</span> <span class=p>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=nb>int64</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>threshold</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>ix</span> <span class=p>=</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl><span class=nx>z</span> <span class=p>=</span> <span class=p>(</span><span class=nx>z</span> <span class=o>*</span> <span class=nx>z</span><span class=p>)</span> <span class=o>+</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>cmplx</span><span class=p>.</span><span class=nf>Abs</span><span class=p>(</span><span class=nx>z</span><span class=p>)</span> <span class=p>&gt;</span> <span class=mi>4</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=nx>ix</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>mandelbrot</span><span class=p>(</span><span class=nx>threshold</span><span class=p>,</span> <span class=nx>density</span> <span class=kt>int64</span><span class=p>)</span> <span class=p>[][]</span><span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>realAxis</span> <span class=o>:=</span> <span class=nf>linspace</span><span class=p>(</span><span class=o>-</span><span class=mf>0.22</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.219</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>imaginaryAxis</span> <span class=o>:=</span> <span class=nf>linspace</span><span class=p>(</span><span class=o>-</span><span class=mf>0.70</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.699</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;realAxis %v\n&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>realAxis</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;imaginaryAxis %v\n&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>imaginaryAxis</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nx>atlas</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([][]</span><span class=kt>int64</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>realAxis</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>atlas</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>atlas</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int64</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>imaginaryAxis</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;atlas %v\n&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>atlas</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nx>ix</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>realAxis</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nx>iy</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>imaginaryAxis</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>cx</span> <span class=o>:=</span> <span class=nx>realAxis</span><span class=p>[</span><span class=nx>ix</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>cy</span> <span class=o>:=</span> <span class=nx>imaginaryAxis</span><span class=p>[</span><span class=nx>iy</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>c</span> <span class=o>:=</span> <span class=nb>complex</span><span class=p>(</span><span class=nx>cx</span><span class=p>,</span> <span class=nx>cy</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>//fmt.Printf(&#34;ix, iy: %v %v\n&#34;, ix, iy)</span>
</span></span><span class=line><span class=cl><span class=nx>atlas</span><span class=p>[</span><span class=nx>ix</span><span class=p>][</span><span class=nx>iy</span><span class=p>]</span> <span class=p>=</span> <span class=nf>countIterationsUntilDivergent</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>threshold</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=nx>atlas</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></p><h4 id=multi-threaded-1>Multi-Threaded</h4><p>Go makes this a lot easier, by using a concept called <code>goroutines</code>. Instead of having to deal with the Python
<code>mutltiprocessing</code> module, <code>pools</code>, <code>map</code> vs. <code>starmap</code> and the intricacies of the Python Interpreter, we can simply use
the <code>go</code> directive.</p><blockquote><p>As I&rsquo;ve mentioned earlier, the code here is intentionally simple and could be trivially optimized, but I tried to keep
the <code>go</code> code as close to the <code>Python</code> code as possible. Please forgive any simplifications.</p></blockquote><p>First, we&rsquo;ll re-create the <code>calc_row</code> method from Python, this time using a <code>struct</code> to return the indexes and the
value, as the <code>channel</code> we&rsquo;ll use in second won&rsquo;t take multiple return types:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>triple</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>ix</span><span class=p>,</span> <span class=nx>iy</span> <span class=kt>int64</span>
</span></span><span class=line><span class=cl><span class=nx>c</span> <span class=kt>int64</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>calcRow</span><span class=p>(</span><span class=nx>ix</span><span class=p>,</span> <span class=nx>iy</span> <span class=kt>int64</span><span class=p>,</span> <span class=nx>c</span> <span class=kt>complex128</span><span class=p>,</span> <span class=nx>threshold</span> <span class=kt>int64</span><span class=p>)</span> <span class=nx>triple</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=nx>triple</span><span class=p>{</span><span class=nx>ix</span><span class=p>,</span> <span class=nx>iy</span><span class=p>,</span> <span class=nf>countIterationsUntilDivergent</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>threshold</span><span class=p>)}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></p><p>Our main function will use 2 concepts: <code>channels</code> and the aforementioned <code>goroutine</code>.</p><p>A <a href=https://golang.org/doc/effective_go.html#goroutines target=_blank rel="nofollow noopener noreferrer">goroutine</a>
has a simple model: it is a function executing
concurrently with other goroutines in the same address space. The go docs compare it to the Unix shell <code>&</code> operator,
which I find to be a great analogy.</p><p>The <a href=https://golang.org/doc/effective_go.html#channels target=_blank rel="nofollow noopener noreferrer">channel</a>
we are using is a <em>buffered</em> channel that acts like a
pipe for our concurrent function, as non-buffered channels are blocking by nature.</p><p>Which leads to the following code that wraps the inner loop (see above for comments on trivial optimization and the lack
thereof here - I believe even a pointer to a <code>WaitGroup</code> in the <code>goroutine</code> and a smaller <code>channel buffer</code> might speed
this up, but I haven&rsquo;t tested it yet) in a <code>goroutine</code>.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>mandelbrot</span><span class=p>(</span><span class=nx>threshold</span><span class=p>,</span> <span class=nx>density</span> <span class=kt>int64</span><span class=p>)</span> <span class=p>[][]</span><span class=kt>int64</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>realAxis</span> <span class=o>:=</span> <span class=nf>linspace</span><span class=p>(</span><span class=o>-</span><span class=mf>0.22</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.219</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>imaginaryAxis</span> <span class=o>:=</span> <span class=nf>linspace</span><span class=p>(</span><span class=o>-</span><span class=mf>0.70</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.699</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>atlas</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([][]</span><span class=kt>int64</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>realAxis</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>atlas</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>atlas</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int64</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>imaginaryAxis</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// Make a buffered channel</span>
</span></span><span class=line><span class=cl><span class=nx>ch</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=nx>triple</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>realAxis</span><span class=p>))</span><span class=o>*</span><span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>imaginaryAxis</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>ix</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>realAxis</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=nx>ix</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>for</span> <span class=nx>iy</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>imaginaryAxis</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>cx</span> <span class=o>:=</span> <span class=nx>realAxis</span><span class=p>[</span><span class=nx>ix</span><span class=p>]</span>
</span></span><span class=line><span class=cl>				<span class=nx>cy</span> <span class=o>:=</span> <span class=nx>imaginaryAxis</span><span class=p>[</span><span class=nx>iy</span><span class=p>]</span>
</span></span><span class=line><span class=cl>				<span class=nx>c</span> <span class=o>:=</span> <span class=nb>complex</span><span class=p>(</span><span class=nx>cx</span><span class=p>,</span> <span class=nx>cy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=nx>res</span> <span class=o>:=</span> <span class=nf>calcRow</span><span class=p>(</span><span class=nb>int64</span><span class=p>(</span><span class=nx>ix</span><span class=p>),</span> <span class=nb>int64</span><span class=p>(</span><span class=nx>iy</span><span class=p>),</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>threshold</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=nx>ch</span> <span class=o>&lt;-</span> <span class=nx>res</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>}(</span><span class=nx>ix</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=nb>int64</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>realAxis</span><span class=p>))</span><span class=o>*</span><span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>imaginaryAxis</span><span class=p>));</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>case</span> <span class=nx>res</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>ch</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=nx>atlas</span><span class=p>[</span><span class=nx>res</span><span class=p>.</span><span class=nx>ix</span><span class=p>][</span><span class=nx>res</span><span class=p>.</span><span class=nx>iy</span><span class=p>]</span> <span class=p>=</span> <span class=nx>res</span><span class=p>.</span><span class=nx>c</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>atlas</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></p><p>Now, for <code>go</code>, we&rsquo;re looking at <strong>0.38s</strong> on a single CPU and <strong>0.18s</strong> concurrently in code that, while similar, is a
lot more concise.</p><h3 id=final-performance>Final Performance</h3><p>I&rsquo;m just going to leave this here. As I&rsquo;ve outlined previously, both the <code>go</code> and <code>Python</code> code can be further
optimized, but we still get a speedup of ~45x
<img src=images/gopyperf.png alt></p><h2 id=real-life-considerations>Real-Life Considerations</h2><p>Talking about theoretical concepts might be interesting, but that is only a relatively small part of the puzzle. While I
am sure 2020 will be the year of <code>Haskell</code> in widespread production use, my approach to choosing, using, and
recommending people to learn a language is mostly based around real-life uses, less so academic ideals.</p><h3 id=language-popularity>Language Popularity</h3><p>This is always a fun one.</p><p>As per <a href="https://insights.stackoverflow.com/trends?tags=go%2Cpython" target=_blank rel="nofollow noopener noreferrer">StackOverflow</a>
, the popularity of go-related
questions doesn&rsquo;t even come close to the major player that is Python.</p><p><img src=images/go_python_so_1.svg alt></p><p>Plotting this against some other big and small players - Java, Haskell, Scala, Lisp - shows similar results:</p><p><img src=images/go_python_so_2.svg alt></p><p>Now: Is &ldquo;% of questions asked&rdquo; a great metric? Probably not. Python is a very popular language to learn - I was just
involved in preparing a training for it myself - and will naturally attract a huge crowd from both beginners and
seasoned professionals.</p><p>The Google trends show a similar story:
<img src=images/go_py_googletrends.png alt="Google Trends">
(red - <code>Python</code>; blue - <code>go</code>)</p><p>I think its fair to say that Python is a lot more popular - but also that <code>go</code> has at least a niche, if not one one an
upward trajectory. With the power of deceptive visualization, we can zoom into the above StackOverflow Graph:</p><p><img src=images/go_zoom_so.svg alt="Go SO"></p><p>And do, in fact, find an upward trajectory.</p><p>Furthermore, if StackOverflow&rsquo;s
yearly <a href=https://insights.stackoverflow.com/survey/2019#most-popular-technologies target=_blank rel="nofollow noopener noreferrer">developer survey</a>
is to be believed,
<code>go</code> went up from 7.2% in 2018, to 8.8% in 2019, and up to 9.4%
in <a href=https://insights.stackoverflow.com/survey/2020#technology-programming-scripting-and-markup-languages-professional-developers target=_blank rel="nofollow noopener noreferrer">2020</a>
when asked about &ldquo;Most Popular Technologies&rdquo;.</p><p>As per
the <a href=https://insights.stackoverflow.com/survey/2020#technology-what-languages-are-associated-with-the-highest-salaries-worldwide-united-states target=_blank rel="nofollow noopener noreferrer">same survey</a>
,
<code>go</code> programmers in the United States also rank #2 (up from #3 in 2019) in pay at $140,000 p.a., just behind <code>Scala</code> ($
150,000).</p><p>There is hope! :)</p><h3 id=ecosystem>Ecosystem</h3><p>Part of what explains the previous 2 graphs is the enormously wide ecosystem for Python - backend, frontend, statistics,
machine learning, deep learning, graph analysis, GIS, robotics - it is there and it will have thousands of contributors
and tens or hundreds of thousands users.</p><p>There are equivalents and I&rsquo;ve tried to sum them up, alongside their relative popularity on GitHub here:</p><table><thead><tr><th>Framework</th><th>Python</th><th>Contributors</th><th>Stars</th><th>go</th><th>Contributors</th><th>Stars</th></tr></thead><tbody><tr><td>Data Processing</td><td><a href=https://github.com/apache/spark target=_blank rel="nofollow noopener noreferrer">Apache Spark</a></td><td>1505</td><td>26300</td><td><a href=https://github.com/apache/beam target=_blank rel="nofollow noopener noreferrer">Apache Beam</a>
[1]</td><td>608</td><td>4000</td></tr><tr><td>Statistics</td><td><a href=https://github.com/scikit-learn/scikit-learn target=_blank rel="nofollow noopener noreferrer">scikit-learn</a></td><td>1703</td><td>41100</td><td><a href=https://github.com/pa-m/sklearn target=_blank rel="nofollow noopener noreferrer">sklearn</a></td><td>4</td><td>200</td></tr><tr><td>Numerical Library</td><td><a href=https://github.com/numpy/numpy target=_blank rel="nofollow noopener noreferrer">numpy</a></td><td>931</td><td>14000</td><td><a href=https://github.com/gonum/gonum target=_blank rel="nofollow noopener noreferrer">gonum</a></td><td>84</td><td>3900</td></tr><tr><td>Deep Learning</td><td><a href=https://github.com/tensorflow/tensorflow target=_blank rel="nofollow noopener noreferrer">tensorflow</a></td><td>2521</td><td>145000</td><td><a href=https://github.com/tensorflow/tensorflow/tree/master/tensorflow/go target=_blank rel="nofollow noopener noreferrer">tensorflow</a>
(experimental)</td><td>2521</td><td>145000</td></tr><tr><td>Dataframes</td><td><a href=https://github.com/pandas-dev/pandas target=_blank rel="nofollow noopener noreferrer">pandas</a></td><td>1956</td><td>25300</td><td><a href=https://github.com/rocketlaunchr/dataframe-go target=_blank rel="nofollow noopener noreferrer">dataframe-go</a></td><td>3</td><td>246</td></tr></tbody></table><p>It is fairly clear that, at least from a data engineering and data science perspective, the go ecosystem has a long way
to go.</p><p><em>[1] Apache Beam is not a replacement for Spark</em></p><h3 id=learning-curve>Learning Curve</h3><p>This one is subjective - I personally find <code>Python</code> to be easier to learn only on the surface. <code>Python</code> is truly a
rabbit hole, not unlike <code>Java</code>, if you really want to understand underlying concepts, architectures, and libraries.</p><p><code>go</code>, on the other hand, is a fairly simple language that focusses on certain elements. Allow me to quote:</p><blockquote><p>When Go was designed, Java and C++ were the most commonly used languages for writing servers, at least at Google. We
felt that these languages required too much bookkeeping and repetition. Some programmers reacted by moving towards
more
dynamic, fluid languages like Python, at the cost of efficiency and type safety. We felt it should be possible to have
the efficiency, the safety, and the fluidity in a single language.</p><p>Go attempts to reduce the amount of typing in both senses of the word. Throughout its design, we have tried to reduce
clutter and complexity. There are no forward declarations and no header files; everything is declared exactly once.
Initialization is expressive, automatic, and easy to use. Syntax is clean and light on keywords. Stuttering (foo.Foo*
myFoo = new(foo.Foo)) is reduced by simple type derivation using the := declare-and-initialize construct. And perhaps
most radically, there is no type hierarchy: types just are, they don&rsquo;t have to announce their relationships. These
simplifications allow Go to be expressive yet comprehensible without sacrificing, well, sophistication.</p><p>Another important principle is to keep the concepts orthogonal. Methods can be implemented for any type; structures
represent data while interfaces represent abstraction; and so on. Orthogonality makes it easier to understand what
happens when things combine.</p><p><a href=https://golang.org/doc/faq#creating_a_new_language target=_blank rel="nofollow noopener noreferrer">https://golang.org/doc/faq#creating_a_new_language</a></p></blockquote><p>A quick peek at for instance <code>LinkedIn Learning</code> shows a total of 4 courses for <code>go</code> and 168 for <code>Python</code>.</p><p>In my very own experience, the most helpful thing was to go through <a href=https://gobyexample.com/ target=_blank rel="nofollow noopener noreferrer">go by example</a>
and
actually read the docs. Python, on the other hand, as a much broader level of external tutorials, courses,
certifications, blog posts [&mldr;] from people like me, universities, and large companies.</p><blockquote><p>The query &ldquo;go language tutorial&rdquo; returns 1.7bn results on Google, whereas &ldquo;python language tutorial&rdquo; clocks in at
162bn results</p></blockquote><h2 id=apache-beam>Apache Beam</h2><p>Now, we&rsquo;ve talked a lot about <code>go</code> vs <code>Python</code> in general. But what about the opener of this post - where do <code>Beam</code> and
<code>Dataflow</code> come in?</p><blockquote><p>This section will be brief an extended upon in part 2 of this article</p></blockquote><p>In general, the <code>beam</code> <code>go</code> SDK does provide the core functionalities you need to run a relatively simple job. It does,
however, have a list of drawbacks at the time of writing (2020-06-11).</p><h3 id=transformations>Transformations</h3><p>Let&rsquo;s look at available transformations across <code>beam</code>&rsquo;s languages. I&rsquo;ve cherry picked a couple, but feel free to refer
to the overall docs to get a full picture:</p><table><thead><tr><th>Language</th><th>ParDo</th><th>Transforms</th><th>Options</th></tr></thead><tbody><tr><td>Python</td><td>Class</td><td>Pipe-Apply Syntax of classes</td><td>Argparse</td></tr><tr><td>Java</td><td>Static Class</td><td>Daisy-chained apply functions</td><td>Factory Pattern</td></tr><tr><td>go</td><td>Function</td><td>Functions</td><td>flag package</td></tr></tbody></table><p>The most notable difference for people coming from <code>Python</code> will be the overall look of the pipeline.</p><p>This is how it&rsquo;s done in <code>Python</code> (Side note: There is nothing stoping you from calling <code>data.apply(func)</code>, as the
operators are simply overloaded):<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>CountWords</span><span class=p>(</span><span class=n>beam</span><span class=o>.</span><span class=n>PTransform</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>expand</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pcoll</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl><span class=n>pcoll</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Convert lines of text into individual words.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=s1>&#39;ExtractWords&#39;</span> <span class=o>&gt;&gt;</span>
</span></span><span class=line><span class=cl><span class=n>beam</span><span class=o>.</span><span class=n>FlatMap</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[A-Za-z</span><span class=se>\&#39;</span><span class=s1>]+&#39;</span><span class=p>,</span> <span class=n>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Count the number of times each word occurs.</span>
</span></span><span class=line><span class=cl>        <span class=o>|</span> <span class=n>beam</span><span class=o>.</span><span class=n>combiners</span><span class=o>.</span><span class=n>Count</span><span class=o>.</span><span class=n>PerElement</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>counts</span> <span class=o>=</span> <span class=n>lines</span> <span class=o>|</span> <span class=n>CountWords</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div>(Note the <code>|</code> and <code>>></code> notation)</p><p>In <code>go</code>, it looks a lot more like a regular old function:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>CountWords</span><span class=p>(</span><span class=nx>s</span> <span class=nx>beam</span><span class=p>.</span><span class=nx>Scope</span><span class=p>,</span> <span class=nx>lines</span> <span class=nx>beam</span><span class=p>.</span><span class=nx>PCollection</span><span class=p>)</span> <span class=nx>beam</span><span class=p>.</span><span class=nx>PCollection</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nx>s</span> <span class=p>=</span> <span class=nx>s</span><span class=p>.</span><span class=nf>Scope</span><span class=p>(</span><span class=s>&#34;CountWords&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Convert lines of text into individual words.</span>
</span></span><span class=line><span class=cl>	<span class=nx>col</span> <span class=o>:=</span> <span class=nx>beam</span><span class=p>.</span><span class=nf>ParDo</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>extractFn</span><span class=p>,</span> <span class=nx>lines</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Count the number of times each word occurs.</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>stats</span><span class=p>.</span><span class=nf>Count</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span> <span class=nx>col</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></p><blockquote><p>We will explore these details specificallt in part 2</p></blockquote><h3 id=io>I/O</h3><p>I/O is probably the most limited part of the <code>go</code> sdk, with a lot of connectors not being available for go.</p><blockquote><p>Please see <a href=https://beam.apache.org/documentation/io/built-in/ target=_blank rel="nofollow noopener noreferrer">this link</a>
for an up-to-date overview.</p></blockquote><table><thead><tr><th>Type</th><th>Language</th><th>Python</th><th>Java</th><th>go</th></tr></thead><tbody><tr><td>File-based</td><td>FileIO</td><td>Yes</td><td>Yes</td><td>-</td></tr><tr><td>File-based</td><td>AvroIO</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>File-based</td><td>TextIO</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>File-based</td><td>TFRecordIO</td><td>Yes</td><td>Yes</td><td>-</td></tr><tr><td>File-based</td><td>XmlIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>File-based</td><td>TikaIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>File-based</td><td>ParquetIO</td><td>Yes</td><td>Yes</td><td>-</td></tr><tr><td>File-based</td><td>ThriftIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>File-based</td><td>VcfIO</td><td>Yes</td><td>-</td><td>-</td></tr><tr><td>File-based</td><td>S3IO</td><td>Yes</td><td>-</td><td>-</td></tr><tr><td>File-based</td><td>GcsIO</td><td>Yes</td><td>-</td><td>-</td></tr><tr><td>FileSystem</td><td>HadoopFileSystem</td><td>Yes</td><td>Yes</td><td>-</td></tr><tr><td>FileSystem</td><td>GcsFileSystem</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>FileSystem</td><td>LocalFileSystem</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>FileSystem</td><td>S3FileSystem</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>FileSystem</td><td>In-memory</td><td>-</td><td>-</td><td>Yes</td></tr><tr><td>Messaging</td><td>KinesisIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Messaging</td><td>AmqpIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Messaging</td><td>KafkaIO</td><td>Yes</td><td>Yes</td><td>-</td></tr><tr><td>Messaging</td><td>PubSubIO</td><td>Yes</td><td>Yes</td><td>-</td></tr><tr><td>Messaging</td><td>JmsIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Messaging</td><td>MqttIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Messaging</td><td>RabbitMqIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Messaging</td><td>SqsIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Messaging</td><td>SnsIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>CassandraIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>HadoopFormatIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>HBaseIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>HCatalogIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>KuduIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>SolrIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>ElasticsearchIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>BigQueryIO</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Database</td><td>BigTableIO</td><td>Yes</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>DatastoreIO</td><td>Yes</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>SpannerIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>JdbcIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>MongoDbIO</td><td>Yes</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>MongoDbGridFSIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>RedisIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>DynamoDBIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>ClickHouseIO</td><td>-</td><td>Yes</td><td>-</td></tr><tr><td>Database</td><td>DatabaseIO</td><td>-</td><td>-</td><td>Yes</td></tr></tbody></table><p>If I had to give a summary: <code>go</code> on <code>beam</code> supports essential <code>Google Cloud</code> services and local development, whereas
<code>Java</code> covers almost all cases. [2]</p><p><em>[2] Keep in mind that some connectors, like <code>DatabaseIO</code>, are inherently language-specific</em></p><h3 id=runners>Runners</h3><p>Finally, looking the available runners, <code>go</code> is more or less limited to <code>Direct</code> and <code>Dataflow</code>, falling in line with my
statement on I/O.</p><table><thead><tr><th>Language</th><th>Direct</th><th>Apex</th><th>Fink-Local</th><th>Flink-Cluster</th><th>Spark</th><th>Dataflow</th><th>Samza-Local</th><th>Nemo</th><th>Jet</th></tr></thead><tbody><tr><td>Python</td><td>Yes</td><td>-</td><td>(Yes)</td><td>(Yes)</td><td>(Yes)</td><td>Yes</td><td>-</td><td>-</td><td>-</td></tr><tr><td>Java</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>go</td><td>Yes</td><td>-</td><td>-</td><td>-</td><td>-</td><td>(Yes)</td><td>-</td><td>-</td><td>-</td></tr></tbody></table><blockquote><p>A (yes) means that there are limitations to these runners</p></blockquote><h3 id=line-by-line-example>Line-by-Line Example</h3><p>I suggest going through <a href=https://beam.apache.org/get-started/wordcount-example/#minimalwordcount-example target=_blank rel="nofollow noopener noreferrer"><code>WordCount</code></a>
.</p><p><code>WordCount</code> is a great example, as it demonstrates the following concepts:</p><ul><li>Creating the Pipeline</li><li>Applying transforms to the Pipeline</li><li>Reading input</li><li>Applying ParDo transforms</li><li>Applying SDK-provided transforms</li><li>Writing output (in this example: writing to a text file)</li><li>Running the Pipeline</li></ul><p>For the sake of brevity, I won&rsquo;t go into those details at this point.</p><h2 id=conclusion>Conclusion</h2><p>One of the first questions to ask should be: Is there even a point in comparing the two languages? My answer to that
might be obvious - while <code>go</code> might have been designed for different use cases (general purpose scripting and machine
learning use cases vs. systems / &ldquo;cloud&rdquo; programming), the concepts outlined above still make me excited from a data
engineering perspective.</p><p><code>go</code> has many a concept that work without a massive <code>pip</code> dependency tree, produces clean code, is easy to compile,
really fast, and (in my opinion) has a lot of potential for future data and ML use cases.</p><p><strong>In summary: <code>go</code> and <code>Python</code> are obviously very different languages - as I hopefully successfully outlined with my
cherry-picked examples above</strong>.</p><h2 id=next-steps>Next Steps</h2><p>As I&rsquo;ve only skimmed the surface of <code>Apache Beam</code> in this article, the next one will focus on the following questions to
use <code>Dataflow</code> as a real-world example for &ldquo;<code>go</code> in the wild&rdquo;:</p><ul><li>How mature is the <code>go</code> Beam SDK?</li><li>What does it support? What is missing?</li><li>What are fundamental differences?</li><li>(How) can we run a <code>Dataflow</code> job on <code>GCP</code>?</li></ul><p><em>All development and benchmarking was done under GNU/Linux [PopOS! 19.10 on Kernel 5.4] with 12 Intel i7-9750H vCores @
4.5Ghz and 16GB RAM on a 2019 System76 Gazelle Laptop</em></p></div><nav class="hide-on-mobile section-nav"><nav id=TableOfContents><ol><li><a href=#introduction>Introduction</a></li><li><a href=#go-vs-python>Go vs. Python</a><ol><li><a href=#speed>Speed</a></li><li><a href=#static-typing>Static typing</a></li><li><a href=#interfaces-and-structs>Interfaces and Structs</a></li><li><a href=#pointers>Pointers</a></li></ol></li><li><a href=#concurrency-with-a-mandelbrot-set>Concurrency with a Mandelbrot Set</a><ol><li><a href=#python>Python</a></li><li><a href=#go>Go</a></li><li><a href=#final-performance>Final Performance</a></li></ol></li><li><a href=#real-life-considerations>Real-Life Considerations</a><ol><li><a href=#language-popularity>Language Popularity</a></li><li><a href=#ecosystem>Ecosystem</a></li><li><a href=#learning-curve>Learning Curve</a></li></ol></li><li><a href=#apache-beam>Apache Beam</a><ol><li><a href=#transformations>Transformations</a></li><li><a href=#io>I/O</a></li><li><a href=#runners>Runners</a></li><li><a href=#line-by-line-example>Line-by-Line Example</a></li></ol></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#next-steps>Next Steps</a></li></ol></nav></nav></div><div class=post><hr class=footer-separator><div class=tags><ul class=flat><li class=tag-li><a href=../../../tags/go>go</a></li><li class=tag-li><a href=../../../tags/golang>golang</a></li><li class=tag-li><a href=../../../tags/python>python</a></li><li class=tag-li><a href=../../../tags/dataflow>dataflow</a></li><li class=tag-li><a href=../../../tags/beam>beam</a></li><li class=tag-li><a href=../../../tags/spark>spark</a></li><li class=tag-li><a href=../../../tags/big-data>big data</a></li><li class=tag-li><a href=../../../tags/programming>programming</a></li></ul></div><div class=back><a href=https://github.com/vim89/vitthalmirji.com/blob/master/content/posts/2020/06/a-data-engineering-perspective-on-go-vs-python-part-1/index.md title=github><i data-feather=github></i> Edit this on GitHub</a></div><div class=back><a href=https://vitthalmirji.com/><span aria-hidden=true>← Back</span></a></div><div class=back>Next time, we'll talk about <i>"What Tiger King can teach us about x86 Assembly"</i></div></div></div><div class="footer wrapper"><nav class=nav><div>2020 © Copyright notice</div></nav></div><script>feather.replace()</script><script>var enableTruncate=!0,filterDepth=!1;const MAX_DEPTH=9;window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.reverse().forEach(e=>{const n=e.target.getAttribute("id");if(e.intersectionRatio>0){var t=document.querySelectorAll(`nav li a[href="#${n}"]`);t!=null&&t.forEach(e=>{if(e!=null){var t=getDepth(e.parentElement);filterDepth&&t<=MAX_DEPTH&&(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))}else filterDepth||(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))})}})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function isVisible(e){if(!(e instanceof Element))return!1;const n=getComputedStyle(e);if(n.display==="none")return!1;if(n.visibility!=="visible")return!1;if(n.opacity<.1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(t.y<0)return!1;if(t.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let s=document.elementFromPoint(t.x,t.y);do if(s===e)return!0;while(s=s.parentNode)return!1}function clearActiveStatesInTableOfContents(){document.querySelectorAll("nav li").forEach(e=>{e.classList.remove("active")})}function getDepth(e){for(var t=0;e!==null&&e.tagName.toLowerCase()!=="ul";)t++,e=e.parentElement;return t}function navItems(){var e=document.querySelectorAll("nav nav li a");return Array.from(e).filter(e=>e.href!=null&&e.hash.startsWith("#"))}function lasItemInNavBarVisible(){var e=navItems().slice(-1)[0];return isVisible(e)}document.addEventListener("DOMContentLoaded",function(){if(!enableTruncate)return;var e=navItems();console.log(e),lasItemInNavBarVisible()||(filterDepth=!0,e.forEach(function(e){var t=getDepth(e.parentElement);t>MAX_DEPTH&&e.parentElement.classList.add("depth-nested")}))})</script></body></html>