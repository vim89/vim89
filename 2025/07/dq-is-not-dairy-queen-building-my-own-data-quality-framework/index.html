<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>DQ Is Not Dairy Queen: Building My Own Data Quality Framework - Vitthal Mirji</title><link rel=icon type=image/png href=favicon.ico><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="DQ Is Not Dairy Queen: Building My Own Data Quality Framework"><meta itemprop=description content="Building scalable data quality checks from scratch"><meta itemprop=datePublished content="2025-07-15T00:00:00+00:00"><meta itemprop=dateModified content="2025-07-15T00:00:00+00:00"><meta itemprop=wordCount content="434"><meta itemprop=keywords content="Data Quality,Open Source,Scala,Engineering"><meta property="og:url" content="https://vitthalmirji.com/2025/07/dq-is-not-dairy-queen-building-my-own-data-quality-framework/"><meta property="og:site_name" content="Vitthal Mirji"><meta property="og:title" content="DQ Is Not Dairy Queen: Building My Own Data Quality Framework"><meta property="og:description" content="Building scalable data quality checks from scratch"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-15T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-15T00:00:00+00:00"><meta property="article:tag" content="Data Quality"><meta property="article:tag" content="Open Source"><meta property="article:tag" content="Scala"><meta property="article:tag" content="Engineering"><meta name=twitter:card content="summary"><meta name=twitter:title content="DQ Is Not Dairy Queen: Building My Own Data Quality Framework"><meta name=twitter:description content="Building scalable data quality checks from scratch"><link rel=stylesheet type=text/css media=screen href=https://vitthalmirji.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://vitthalmirji.com/css/main.css><link rel=stylesheet type=text/css href=https://vitthalmirji.com/[css/override.css]><link id=dark-scheme rel=stylesheet type=text/css href=https://vitthalmirji.com/css/dark.css><script src=https://vitthalmirji.com/js/feather.min.js></script><script src=https://vitthalmirji.com/js/main.js></script></head><body><div class="container-wide wrapper"><link rel=icon href=../../../favicon.ico sizes=any><link rel=icon type=image/png href=../../../favicon.png><link rel=apple-touch-icon href=../../../apple-touch-icon.png><link rel=manifest href=../../../site.webmanifest><meta name=theme-color content="#ffffff"><link rel=stylesheet href=../../../syntax.css><div class=header><h1 class=site-title><a href=https://vitthalmirji.com/>Vitthal Mirji</a></h1><div class=site-description><p>Software Engineering, Data Engineering, GNU/Linux, Data, ML, and other things</p><nav class="nav social"><ul class=flat><li><a href=https://github.com/vim89/ title=Github><i data-feather=github></i></a></li><li><a href=https://twitter.com/whoami_vim/ title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://www.linkedin.com/in/vitthal10/ title=LinkedIn><i data-feather=linkedin></i></a></li><li><a href=../../../index.xml title=RSS><i data-feather=rss></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=../../../>Home</a></li><li><a href=../../../about>About</a></li><li><a href=../../../tags>Tags & Stats</a></li></ul></nav></div><div class=article-nav id=article-nav-id><div class=post><div class=post-header><div class=meta><div class=date><span class=day>15</span>
<span class=rest>Jul 2025</span></div></div><div class=matter><h1 class=title>DQ Is Not Dairy Queen: Building My Own Data Quality Framework</h1></div></div><aside class=toc id=static-toc><header><h3>Contents</h3></header><nav id=TableOfContents><ol><li><a href=#-dq--ice-cream>🍦 DQ ≠ Ice Cream</a></li><li><a href=#-why-i-built-it>💡 Why I Built It</a></li><li><a href=#-what-it-does>⚙️ What It Does</a></li><li><a href=#-dpat-declarative-checks-that-read-like-english>📄 DPAT: Declarative Checks That Read Like English</a></li><li><a href=#-code-level-constraints-in-scala>🔍 Code-Level Constraints in Scala</a></li><li><a href=#-visualizing-failures>📈 Visualizing Failures</a></li><li><a href=#-plug-it-in-your-pipelines>🛠 Plug It In Your Pipelines</a></li><li><a href=#-open-source-not-yet-but>🔗 Open Source? Not Yet. But&mldr;</a></li><li><a href=#-tldr>✅ TL;DR</a></li></ol></nav></aside><h2 id=-dq--ice-cream>🍦 DQ ≠ Ice Cream</h2><p>When someone hears “DQ Framework,” I get asked if it comes with sprinkles. It doesn’t. It comes with sanity-saving data
validations, automatable quality checks, and opinionated constraints that don’t melt under pressure.</p><p>So no, this isn’t about Dairy Queen. But it <em>does</em> prevent frozen pipelines. ❄️</p><hr><h2 id=-why-i-built-it>💡 Why I Built It</h2><p>Every data engineer has been there:</p><ul><li>A critical job runs on time&mldr; and writes garbage.</li><li>Downstream dashboards look suspiciously optimistic.</li><li>Stakeholders smile because they don’t know 18% of yesterday’s rows are NULL.</li></ul><p>I couldn’t keep slapping <code>WHERE col IS NOT NULL</code> forever. So I built a reusable, testable <strong>Data Quality Framework</strong> (
DQF) and paired it with a <strong>Declarative Pipeline Assurance Tool</strong> (DPAT).</p><hr><h2 id=-what-it-does>⚙️ What It Does</h2><p>Think of this as <code>scalatest</code> meets <code>dbt tests</code> meets <strong>common sense</strong>:</p><ul><li>✅ Schema checks: missing columns, data types, required fields</li><li>✅ Value constraints: uniqueness, nullability, allowed ranges</li><li>✅ Volume & frequency checks: &ldquo;is my partition even here?&rdquo;</li><li>✅ Aggregation deltas: &ldquo;is this spike normal?&rdquo;</li></ul><hr><h2 id=-dpat-declarative-checks-that-read-like-english>📄 DPAT: Declarative Checks That Read Like English</h2><p>Here’s a real example from our YAML-based DPAT engine:</p><pre class="code-block language-yaml">
  <code>checks:
  - name: transactions_have_valid_amounts
    type: range
    column: transaction_amount
    min: 0
    max: 99999
    severity: error

  - name: daily_volume_sanity
    type: row_count
    expected_range: [50000, 60000]
    severity: warning</code>
</pre><p>You define expectations. It tests them. CI/CD blocks if it must.</p><hr><h2 id=-code-level-constraints-in-scala>🔍 Code-Level Constraints in Scala</h2><p>Here’s how we express constraints in the DQ library:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-scala data-lang=scala><span class=line><span class=cl><span class=nc>Constraint</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>on</span><span class=o>(</span><span class=s>&#34;user_id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>isNotNull</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>and</span><span class=o>(</span><span class=s>&#34;email&#34;</span><span class=o>).</span><span class=n>matchesRegex</span><span class=o>(</span><span class=s>&#34;.+@.+\\..+&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>and</span><span class=o>(</span><span class=s>&#34;signup_date&#34;</span><span class=o>).</span><span class=n>isInPast</span></span></span></code></pre></td></tr></table></div></div><p>You can attach them inline with dataframes or bind them to Spark Datasets with implicits.</p><hr><h2 id=-visualizing-failures>📈 Visualizing Failures</h2><p>All test results emit to JSON, Slack webhooks, and Looker dashboards.</p><pre class="code-block language-json">
  <code>{
  "check": "transactions_have_valid_amounts",
  "status": "FAILED",
  "failures": 328,
  "details": "328 rows exceeded max=99999"
}</code>
</pre><p>Or you can just scroll through a <code>dq_results.html</code> report with filters by severity.</p><hr><h2 id=-plug-it-in-your-pipelines>🛠 Plug It In Your Pipelines</h2><p>You can wire this into:</p><ul><li>Airflow DAGs (as standalone Python ops via REST)</li><li>Spark ETL pipelines (Scala SDK)</li><li>Shell scripts (CLI + exit codes)</li><li>CI/CD (GitHub Actions / GitLab CI)</li></ul><hr><h2 id=-open-source-not-yet-but>🔗 Open Source? Not Yet. But&mldr;</h2><p>This started internally, but parts of it are being modularized. The goal is to OSS:</p><ul><li>Reusable constraint library</li><li>YAML-based test definition DSL</li><li>CLI test runner + report UI</li></ul><hr><h2 id=-tldr>✅ TL;DR</h2><ul><li>If you’re still writing quality checks inline - stop.</li><li>If you think “data quality is someone else’s job” - you’re wrong.</li><li>And if someone says “DQ” and hands you a sundae - take it, but then show them this blog.</li></ul><hr><p>Want early access to the framework? Or have strong opinions about what <em>your</em> DQ system needs?</p><p><a href=mailto:vitthalmirji@gmail.com>Reach out</a>
or <a href=https://github.com/vim89 target=_blank rel="nofollow noopener noreferrer">ping me on GitHub</a>
.</p></div><nav class="hide-on-mobile section-nav"><nav id=TableOfContents><ol><li><a href=#-dq--ice-cream>🍦 DQ ≠ Ice Cream</a></li><li><a href=#-why-i-built-it>💡 Why I Built It</a></li><li><a href=#-what-it-does>⚙️ What It Does</a></li><li><a href=#-dpat-declarative-checks-that-read-like-english>📄 DPAT: Declarative Checks That Read Like English</a></li><li><a href=#-code-level-constraints-in-scala>🔍 Code-Level Constraints in Scala</a></li><li><a href=#-visualizing-failures>📈 Visualizing Failures</a></li><li><a href=#-plug-it-in-your-pipelines>🛠 Plug It In Your Pipelines</a></li><li><a href=#-open-source-not-yet-but>🔗 Open Source? Not Yet. But&mldr;</a></li><li><a href=#-tldr>✅ TL;DR</a></li></ol></nav></nav></div><div class=post><hr class=footer-separator><div class=tags><ul class=flat><li class=tag-li><a href=../../../tags/data-quality>data quality</a></li><li class=tag-li><a href=../../../tags/open-source>open source</a></li><li class=tag-li><a href=../../../tags/scala>scala</a></li><li class=tag-li><a href=../../../tags/engineering>engineering</a></li></ul></div><div class=back><a href=https://github.com/vim89/vitthalmirji.com/blob/master/content/posts/2025/07/data-quality-framework-dq-not-dairy-queen/index.md title=github><i data-feather=github></i> Edit this on GitHub</a></div><div class=back><a href=https://vitthalmirji.com/><span aria-hidden=true>← Back</span></a></div><div class=back>Next time, we'll talk about <i>"What Tiger King can teach us about x86 Assembly"</i></div></div></div><div class="footer wrapper"><nav class=nav><div>2025 © Copyright notice</div></nav></div><script>feather.replace()</script><script>var enableTruncate=!0,filterDepth=!1;const MAX_DEPTH=9;window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.reverse().forEach(e=>{const n=e.target.getAttribute("id");if(e.intersectionRatio>0){var t=document.querySelectorAll(`nav li a[href="#${n}"]`);t!=null&&t.forEach(e=>{if(e!=null){var t=getDepth(e.parentElement);filterDepth&&t<=MAX_DEPTH&&(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))}else filterDepth||(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))})}})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function isVisible(e){if(!(e instanceof Element))return!1;const n=getComputedStyle(e);if(n.display==="none")return!1;if(n.visibility!=="visible")return!1;if(n.opacity<.1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(t.y<0)return!1;if(t.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let s=document.elementFromPoint(t.x,t.y);do if(s===e)return!0;while(s=s.parentNode)return!1}function clearActiveStatesInTableOfContents(){document.querySelectorAll("nav li").forEach(e=>{e.classList.remove("active")})}function getDepth(e){for(var t=0;e!==null&&e.tagName.toLowerCase()!=="ul";)t++,e=e.parentElement;return t}function navItems(){var e=document.querySelectorAll("nav nav li a");return Array.from(e).filter(e=>e.href!=null&&e.hash.startsWith("#"))}function lasItemInNavBarVisible(){var e=navItems().slice(-1)[0];return isVisible(e)}document.addEventListener("DOMContentLoaded",function(){if(!enableTruncate)return;var e=navItems();console.log(e),lasItemInNavBarVisible()||(filterDepth=!0,e.forEach(function(e){var t=getDepth(e.parentElement);t>MAX_DEPTH&&e.parentElement.classList.add("depth-nested")}))})</script></body></html>