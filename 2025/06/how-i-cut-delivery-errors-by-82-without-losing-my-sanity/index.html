<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>How I Cut Delivery Errors by 82% Without Losing My Sanity - Vitthal Mirji</title><link rel=icon type=image/png href=favicon.ico><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="How I Cut Delivery Errors by 82% Without Losing My Sanity"><meta itemprop=description content="A data engineering journey at Walmart—CI/CD, Gated CRQ, DPAT and data contracts"><meta itemprop=datePublished content="2025-06-15T00:00:00+00:00"><meta itemprop=dateModified content="2025-06-15T00:00:00+00:00"><meta itemprop=wordCount content="335"><meta itemprop=keywords content="Data Engineering,CI/CD,Data Quality,DPAT,Gated CRQ,Walmart"><meta property="og:url" content="https://vitthalmirji.com/2025/06/how-i-cut-delivery-errors-by-82-without-losing-my-sanity/"><meta property="og:site_name" content="Vitthal Mirji"><meta property="og:title" content="How I Cut Delivery Errors by 82% Without Losing My Sanity"><meta property="og:description" content="A data engineering journey at Walmart—CI/CD, Gated CRQ, DPAT and data contracts"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-15T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-15T00:00:00+00:00"><meta property="article:tag" content="Data Engineering"><meta property="article:tag" content="CI/CD"><meta property="article:tag" content="Data Quality"><meta property="article:tag" content="DPAT"><meta property="article:tag" content="Gated CRQ"><meta property="article:tag" content="Walmart"><meta name=twitter:card content="summary"><meta name=twitter:title content="How I Cut Delivery Errors by 82% Without Losing My Sanity"><meta name=twitter:description content="A data engineering journey at Walmart—CI/CD, Gated CRQ, DPAT and data contracts"><link rel=stylesheet type=text/css media=screen href=https://vitthalmirji.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://vitthalmirji.com/css/main.css><link rel=stylesheet type=text/css href=https://vitthalmirji.com/[css/override.css]><link id=dark-scheme rel=stylesheet type=text/css href=https://vitthalmirji.com/css/dark.css><script src=https://vitthalmirji.com/js/feather.min.js></script><script src=https://vitthalmirji.com/js/main.js></script></head><body><div class="container wrapper"><link rel=icon href=../../../favicon.ico sizes=any><link rel=icon type=image/png href=../../../favicon.png><link rel=apple-touch-icon href=../../../apple-touch-icon.png><link rel=manifest href=../../../site.webmanifest><meta name=theme-color content="#ffffff"><link rel=stylesheet href=../../../syntax.css><div class=header><h1 class=site-title><a href=https://vitthalmirji.com/>Vitthal Mirji</a></h1><div class=site-description><p>Software Engineering, Data Engineering, GNU/Linux, Data, ML, and other things</p><nav class="nav social"><ul class=flat><li><a href=https://github.com/vim89/ title=Github><i data-feather=github></i></a></li><li><a href=https://twitter.com/whoami_vim/ title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://www.linkedin.com/in/vitthal10/ title=LinkedIn><i data-feather=linkedin></i></a></li><li><a href=../../../index.xml title=RSS><i data-feather=rss></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=../../../>Home</a></li><li><a href=../../../about>About</a></li><li><a href=../../../tags>Tags & Stats</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>15</span>
<span class=rest>Jun 2025</span></div></div><div class=matter><h1 class=title>How I Cut Delivery Errors by 82% Without Losing My Sanity</h1></div></div><h2 id=-the-problem-errors-everywhere>🚨 The Problem: Errors Everywhere</h2><p>At my organization, we were shipping data pipelines faster than ever—but the delivery error rate stayed stubbornly
around <strong>12%</strong>, which meant:</p><ul><li>😓 Manual rollbacks, dashboards showing stale or missing data</li><li>👎 Frustrated teams notifying stakeholders (and me) daily</li><li>🕒 A few hours lost per incident, every day</li></ul><p>It wasn&rsquo;t sustainable—and I&rsquo;d had enough.</p><hr><h2 id=-the-goal>🎯 The Goal</h2><p>Implement a <strong>self-healing pipeline</strong> with:</p><ul><li>Automated quality gates</li><li>Full pipeline rollback on failure</li><li>Clear ownership via data contracts</li><li>Faster failed-job detection</li></ul><p>And yes, keep my sanity intact.</p><hr><h2 id=-the-tools-we-built>🧩 The Tools We Built</h2><h3 id=1-dpat--declarative-pipeline-assurance-tool>1. <strong>DPAT – Declarative Pipeline Assurance Tool</strong></h3><p>Define YAML checks like this:</p><pre class="code-block language-yaml">
  <code>checks:
  - name: "order_date_not_null"
    column: order_date
    type: not_null
    severity: error
  - name: "daily_volume_range"
    type: row_count
    expected_range: [ 1_000_000, 1_100_000 ]
    severity: error</code>
</pre><p>Then wired that into our Spark ETL:</p><pre class="code-block language-scala">
  <code>val results = DPAT.runChecks(df, "orders", date = runDate)
assert(results.isSuccess)</code>
</pre><h3 id=2-gated-crq--quality-gates-at-build-time>2. <strong>Gated CRQ – Quality Gates at Build Time</strong></h3><pre class="code-block language-yaml">
  <code>- name: Run DPAT checks
  run: sbt "runDPAT --date ${{ env.RUN_DATE }}"

- name: Gated CRQ
  if: steps.runDPAT.outcome == 'failure'
  run: exit 1</code>
</pre><p>Failed checks stop the build and prevent broken data releases.</p><h3 id=3-data-contracts-for-ownership>3. <strong>Data Contracts for Ownership</strong></h3><p>We published data schema/contracts like:</p><table><thead><tr><th>Contract Name</th><th>Fields</th><th>Owner</th><th>Version</th></tr></thead><tbody><tr><td>orders</td><td>12</td><td>DataOps Team</td><td>v1.3</td></tr><tr><td>customer_data</td><td>8</td><td>Analytics</td><td>v2.1</td></tr></tbody></table><p>Since enforcing those schemas, compatibility bugs dropped by <strong>45%</strong>.</p><h4 id=-the-before--after-results>📊 The Before / After Results</h4><table><thead><tr><th>Metric</th><th>Before</th><th>After</th></tr></thead><tbody><tr><td>Pipeline failures per week</td><td>5</td><td>0–1</td></tr><tr><td>Daily error resolution time</td><td>3 hours</td><td>30 min</td></tr><tr><td>Delivery error rate</td><td>12%</td><td>2%</td></tr></tbody></table><p>That’s how delivery errors dropped ~82%.</p><h4 id=-architecture-overview>🏛️ Architecture Overview</h4><pre class="code-block language-prettier">
  <code>[Source System] → [Spark ETL Job] → DPAT Checks → Data Contract Validator → Data Lake
                            │
                            ↓ (on fail)
                  [CI/CD Rollback & Alerts]</code>
</pre><h4 id=-what-this-all-really-means>✅ What This All Really Means</h4><ul><li>Better pipeline confidence across teams</li><li>Automated data quality enforcement at scale</li><li>Fewer late-night firefights—and a lot less stress</li></ul><p>⸻</p><h4 id=-how-to-apply-this>🔧 How to Apply This</h4><p>If you’re facing similar issues:</p><ol><li>Build a declarative check engine (like DPAT)</li><li>Gate your deployments with your checks</li><li>Publish strict data contracts</li><li>Automate it with CI/CD</li></ol><hr class=footer-separator><div class=tags><ul class=flat><li class=tag-li><a href=../../../tags/data-engineering>data engineering</a></li><li class=tag-li><a href=../../../tags/ci/cd>CI/CD</a></li><li class=tag-li><a href=../../../tags/data-quality>data quality</a></li><li class=tag-li><a href=../../../tags/dpat>DPAT</a></li><li class=tag-li><a href=../../../tags/gated-crq>Gated CRQ</a></li><li class=tag-li><a href=../../../tags/walmart>Walmart</a></li></ul></div><div class=back><a href=https://github.com/vim89/vitthalmirji.com/blob/master/content/posts/2025/06/cut-delivery-errors-without-losing-sanity/index.md title=github><i data-feather=github></i> Edit this on GitHub</a></div><div class=back><a href=https://vitthalmirji.com/><span aria-hidden=true>← Back</span></a></div><div class=back>Next time, we'll talk about <i>"10 Reasons why gcc SHOULD be re-written in JavaScript - You won't believe #8!"</i></div></div></div><div class="footer wrapper"><nav class=nav><div>2025 © Copyright notice</div></nav></div><script>feather.replace()</script></body></html>