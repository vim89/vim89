<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>How I Cut Delivery Errors by 82% Without Losing My Sanity - Vitthal Mirji</title><link rel=icon type=image/png href=favicon.ico><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="How I Cut Delivery Errors by 82% Without Losing My Sanity"><meta itemprop=description content="A data engineering journey at Walmartâ€”CI/CD, Gated CRQ, DPAT and data contracts"><meta itemprop=datePublished content="2025-06-15T00:00:00+00:00"><meta itemprop=dateModified content="2025-06-15T00:00:00+00:00"><meta itemprop=wordCount content="352"><meta itemprop=keywords content="Data Engineering,CI/CD,Data Quality,DPAT,Gated CRQ,Walmart"><meta property="og:url" content="https://vitthalmirji.com/2025/06/how-i-cut-delivery-errors-by-82-without-losing-my-sanity/"><meta property="og:site_name" content="Vitthal Mirji"><meta property="og:title" content="How I Cut Delivery Errors by 82% Without Losing My Sanity"><meta property="og:description" content="A data engineering journey at Walmartâ€”CI/CD, Gated CRQ, DPAT and data contracts"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-15T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-15T00:00:00+00:00"><meta property="article:tag" content="Data Engineering"><meta property="article:tag" content="CI/CD"><meta property="article:tag" content="Data Quality"><meta property="article:tag" content="DPAT"><meta property="article:tag" content="Gated CRQ"><meta property="article:tag" content="Walmart"><meta name=twitter:card content="summary"><meta name=twitter:title content="How I Cut Delivery Errors by 82% Without Losing My Sanity"><meta name=twitter:description content="A data engineering journey at Walmartâ€”CI/CD, Gated CRQ, DPAT and data contracts"><link rel=stylesheet type=text/css media=screen href=https://vitthalmirji.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://vitthalmirji.com/css/main.css><link rel=stylesheet type=text/css href=https://vitthalmirji.com/[css/override.css]><link id=dark-scheme rel=stylesheet type=text/css href=https://vitthalmirji.com/css/dark.css><script src=https://vitthalmirji.com/js/feather.min.js></script><script src=https://vitthalmirji.com/js/main.js></script></head><body><div class="container wrapper"><link rel=icon href=../../../favicon.ico sizes=any><link rel=icon type=image/png href=../../../favicon.png><link rel=apple-touch-icon href=../../../apple-touch-icon.png><link rel=manifest href=../../../site.webmanifest><meta name=theme-color content="#ffffff"><link rel=stylesheet href=../../../syntax.css><div class=header><h1 class=site-title><a href=https://vitthalmirji.com/>Vitthal Mirji</a></h1><div class=site-description><p>Software Engineering, Data Engineering, GNU/Linux, Data, ML, and other things</p><nav class="nav social"><ul class=flat><li><a href=https://github.com/vim89/ title=Github><i data-feather=github></i></a></li><li><a href=https://twitter.com/whoami_vim/ title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://www.linkedin.com/in/vitthal10/ title=LinkedIn><i data-feather=linkedin></i></a></li><li><a href=../../../index.xml title=RSS><i data-feather=rss></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=../../../>Home</a></li><li><a href=../../../about>About</a></li><li><a href=../../../tags>Tags & Stats</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>15</span>
<span class=rest>Jun 2025</span></div></div><div class=matter><h1 class=title>How I Cut Delivery Errors by 82% Without Losing My Sanity</h1></div></div><h2 id=-the-problem-errors-everywhere>ğŸš¨ The Problem: Errors Everywhere</h2><p>At my organization, we were shipping data pipelines faster than everâ€”but the delivery error rate stayed stubbornly
around <strong>12%</strong>, which meant:</p><ul><li>ğŸ˜“ Manual rollbacks, dashboards showing stale or missing data</li><li>ğŸ‘ Frustrated teams notifying stakeholders (and me) daily</li><li>ğŸ•’ A few hours lost per incident, every day</li></ul><p>It wasn&rsquo;t sustainableâ€”and I&rsquo;d had enough.</p><hr><h2 id=-the-goal>ğŸ¯ The Goal</h2><p>Implement a <strong>self-healing pipeline</strong> with:</p><ul><li>Automated quality gates</li><li>Full pipeline rollback on failure</li><li>Clear ownership via data contracts</li><li>Faster failed-job detection</li></ul><p>And yes, keep my sanity intact.</p><hr><h2 id=-the-tools-we-built>ğŸ§© The Tools We Built</h2><h3 id=1-dpat--declarative-pipeline-assurance-tool>1. <strong>DPAT â€“ Declarative Pipeline Assurance Tool</strong></h3><p>Define YAML checks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>checks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;order_date_not_null&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>column</span><span class=p>:</span><span class=w> </span><span class=l>order_date</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>not_null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>error</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;daily_volume_range&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>row_count</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>expected_range</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=l>1_000_000, 1_100_000 ]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>error</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Then wired that into our Spark ETL:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-scala data-lang=scala><span class=line><span class=cl><span class=k>val</span> <span class=n>results</span> <span class=k>=</span> <span class=nc>DPAT</span><span class=o>.</span><span class=n>runChecks</span><span class=o>(</span><span class=n>df</span><span class=o>,</span> <span class=s>&#34;orders&#34;</span><span class=o>,</span> <span class=n>date</span> <span class=k>=</span> <span class=n>runDate</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>assert</span><span class=o>(</span><span class=n>results</span><span class=o>.</span><span class=n>isSuccess</span><span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-gated-crq--quality-gates-at-build-time>2. <strong>Gated CRQ â€“ Quality Gates at Build Time</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Run DPAT checks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>sbt &#34;runDPAT --date ${{ env.RUN_DATE }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Gated CRQ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>steps.runDPAT.outcome == &#39;failure&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>exit 1</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Failed checks stop the build and prevent broken data releases.</p><h3 id=3-data-contracts-for-ownership>3. <strong>Data Contracts for Ownership</strong></h3><p>We published data schema/contracts like:</p><table><thead><tr><th>Contract Name</th><th>Fields</th><th>Owner</th><th>Version</th></tr></thead><tbody><tr><td>orders</td><td>12</td><td>DataOps Team</td><td>v1.3</td></tr><tr><td>customer_data</td><td>8</td><td>Analytics</td><td>v2.1</td></tr></tbody></table><p>Since enforcing those schemas, compatibility bugs dropped by <strong>45%</strong>.</p><h4 id=-the-before--after-results>ğŸ“Š The Before / After Results</h4><table><thead><tr><th>Metric</th><th>Before</th><th>After</th></tr></thead><tbody><tr><td>Pipeline failures per week</td><td>5</td><td>0â€“1</td></tr><tr><td>Daily error resolution time</td><td>3 hours</td><td>30 min</td></tr><tr><td>Delivery error rate</td><td>12%</td><td>2%</td></tr></tbody></table><p>Thatâ€™s how delivery errors dropped ~82%.</p><h4 id=-architecture-overview>ğŸ›ï¸ Architecture Overview</h4><pre tabindex=0><code class=language-prettier data-lang=prettier>[Source System] â†’ [Spark ETL Job] â†’ DPAT Checks â†’ Data Contract Validator â†’ Data Lake
                            â”‚
                            â†“ (on fail)
                  [CI/CD Rollback &amp; Alerts]
</code></pre><h4 id=-what-this-all-really-means>âœ… What This All Really Means</h4><ul><li>Better pipeline confidence across teams</li><li>Automated data quality enforcement at scale</li><li>Fewer late-night firefightsâ€”and a lot less stress</li></ul><p>â¸»</p><h4 id=-how-to-apply-this>ğŸ”§ How to Apply This</h4><p>If youâ€™re facing similar issues:</p><ol><li>Build a declarative check engine (like DPAT)</li><li>Gate your deployments with your checks</li><li>Publish strict data contracts</li><li>Automate it with CI/CD</li></ol><hr class=footer-separator><div class=tags><ul class=flat><li class=tag-li><a href=../../../tags/data-engineering>data engineering</a></li><li class=tag-li><a href=../../../tags/ci/cd>CI/CD</a></li><li class=tag-li><a href=../../../tags/data-quality>data quality</a></li><li class=tag-li><a href=../../../tags/dpat>DPAT</a></li><li class=tag-li><a href=../../../tags/gated-crq>Gated CRQ</a></li><li class=tag-li><a href=../../../tags/walmart>Walmart</a></li></ul></div><div class=back><a href=https://github.com/vim89/vitthalmirji.com/blob/master/content/posts/2025/06/cut-delivery-errors-without-losing-sanity/index.md title=github><i data-feather=github></i> Edit this on GitHub</a></div><div class=back><a href=https://vitthalmirji.com/><span aria-hidden=true>â† Back</span></a></div><div class=back>Next time, we'll talk about <i>"What Tiger King can teach us about x86 Assembly"</i></div></div></div><div class="footer wrapper"><nav class=nav><div>2025 Â© Copyright notice</div></nav></div><script>feather.replace()</script></body></html>